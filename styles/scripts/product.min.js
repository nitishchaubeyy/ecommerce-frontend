const productDetailContainer=document.getElementById("product-detail"),params=new URLSearchParams(window.location.search),productId=params.get("id");function setupInteractions(e){const t=document.getElementById("quantity"),n=document.getElementById("increase"),o=document.getElementById("decrease"),c=document.getElementById("totalPrice"),r=parseFloat(document.getElementById("unitPrice").dataset.price)||0;function a(){let e=parseInt(t.value);e=isNaN(e)||e<1?e=1:e=e,t.value=e,c.textContent=(e*r).toFixed(2)}n.onclick=()=>{t.value=Math.min(10,parseInt(t.value)||1)+1,a()},o.onclick=()=>{t.value=Math.max(1,parseInt(t.value)||1-1),a()},t.oninput=a,document.getElementById("addToCart").onclick=()=>{const n=document.getElementById("size").value,o=parseInt(t.value)||1;let c=JSON.parse(localStorage.getItem("cart"))||[];const r=c.find(t=>t.id===e.id&&t.size===n);r?r.quantity+=o:c.push({id:e.id,title:e.title,price:e.price,image:e.image,size:n,quantity:o}),localStorage.setItem("cart",JSON.stringify(c)),updateCartCount(),alert("✅ Added to cart!")}}function updateCartCount(){const e=JSON.parse(localStorage.getItem("cart"))||[],t=e.reduce((e,t)=>e+t.quantity,0),n=document.querySelector(".cart-icon .badge");n&&(n.textContent=t)}productId&&fetch(`https://fakestoreapi.com/products/${productId}`).then(e=>e.json()).then(e=>{productDetailContainer.innerHTML=`<div class="product-detail-card"><div class="image-zoom-container"><img id="productImage" src="${e.image}" alt="${e.title}" /></div><div class="product-info"><h2>${e.title}</h2><p class="price" id="unitPrice" data-price="${e.price}">$${e.price}</p><label for="size">Size:</label><select id="size"><option value="S">Small</option><option value="M" selected>Medium</option><option value="L">Large</option></select><div class="quantity-selector"><button id="decrease">−</button><input type="number" id="quantity" value="1" min="1" /><button id="increase">+</button></div><p>Total: $<span id="totalPrice">${e.price}</span></p><button id="addToCart">Add to Cart</button></div></div>`,setupInteractions(e)}).catch(e=>{productDetailContainer.innerHTML='<p style="color:red;">Failed to load product.</p>',console.error(e)}),updateCartCount();
