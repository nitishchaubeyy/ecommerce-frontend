const productDetailContainer=document.getElementById("product-detail"),params=new URLSearchParams(window.location.search),productId=params.get("id");function setupInteractions(e){console.log("setupInteractions received:",e);const t=document.getElementById("quantity"),n=document.getElementById("increase"),o=document.getElementById("decrease"),r=document.getElementById("totalPrice"),a=parseFloat(document.getElementById("unitPrice").dataset.price)||0;function c(){let e=parseInt(t.value);isNaN(e)||e<1?e=1:e=e,t.value=e,r.textContent=(e*a).toFixed(2)}n.onclick=()=>{t.value=Math.min(10,parseInt(t.value)||1)+1,c()},o.onclick=()=>{t.value=Math.max(1,parseInt(t.value)||1-1),c()},t.oninput=c,document.getElementById("addToCart").onclick=()=>{const n=document.getElementById("size").value,o=parseInt(t.value)||1;let r=JSON.parse(localStorage.getItem("cart"))||[];const a=r.find(t=>t.id===e.id&&t.size===n);a?a.quantity+=o:r.push({id:e.id,title:e.title||"Untitled",price:e.price||0,image:e.image||"https://via.placeholder.com/100",size:n,quantity:o}),localStorage.setItem("cart",JSON.stringify(r)),updateCartCount(),alert("✅ Added to cart!")}}function updateCartCount(){const e=JSON.parse(localStorage.getItem("cart"))||[],t=e.reduce((e,t)=>e+(t.quantity||1),0),n=document.querySelector(".cart-icon .badge");n&&(n.textContent=t)}productId&&fetch(`https://fakestoreapi.com/products/${productId}`).then(t=>t.json()).then(t=>{console.log("Fetched product:",t),productDetailContainer.innerHTML=`<div class="product-detail-card"><div class="image-zoom-container"><img id="productImage" src="${t.image}" alt="${t.title}" /></div><div class="product-info"><h2>${t.title}</h2><p class="price" id="unitPrice" data-price="${t.price}">$${t.price}</p><label for="size">Size:</label><select id="size"><option value="S">Small</option><option value="M" selected>Medium</option><option value="L">Large</option></select><div class="quantity-selector"><button id="decrease">−</button><input type="number" id="quantity" value="1" min="1" /><button id="increase">+</button></div><p>Total: $<span id="totalPrice">${t.price}</span></p><button id="addToCart">Add to Cart</button></div></div>`,setupInteractions(t)}).catch(e=>{productDetailContainer.innerHTML='<p style="color:red;">Failed to load product.</p>',console.error(e)}),updateCartCount();
